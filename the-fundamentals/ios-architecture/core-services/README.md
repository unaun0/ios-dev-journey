# Core Services Layer

Этот уровень предоставляет приложениям основные сервисы, не связанные напрямую с пользовательским интерфейсом, и зависит от технологий нижних уровней системы, таких как Core OS и Kernel and Device Drivers.

![](https://media2.dev.to/dynamic/image/width=800%2Cheight=%2Cfit=scale-down%2Cgravity=auto%2Cformat=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fe2wjp1il8ymdrtahspdp.png)

Основные службы часто используют функциональность, предоставляемую Core OS, для реализации более сложных функций, характерных для конкретных приложений. Основные службы предоставляют приложениям необходимые сервисы, но не оказывают прямого влияния на пользовательский интерфейс приложения.

![](https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/OSX_Technology_Overview/art/osx_architecture-core_services_2x.png)

## Интеграция с социальными сетями

Фреймворки __Accounts__ и __Social__ облегчают пользователям обмен контентом с различными социальными сетями непосредственно из приложения. 

__Accounts.framework__ предоставляет доступ к учетным записям, хранящимся в базе данных __Accounts__, а __Social.framework__ предлагает API для отправки запросов к поддерживаемым социальным сервисам от имени пользователей.

## Хранение данных в iCloud

__iCloud__ автоматически делает личный контент пользователя доступным на всех его устройствах.

Приложения могут использовать три типа хранения в iCloud:

* Хранение документов для файлового контента, видимого пользователю.
* Хранение ключ-значение для обмена небольшими объемами данных между экземплярами приложения.
* Хранение Core Data для структурированного контента в многопользовательских базах данных.

## CloudKit

Предоставляет приложениям больший контроль над тем, когда и как данные сохраняются в iCloud. В отличие от iCloud Storage, CloudKit работает с существующими структурами данных приложения и поддерживает сохранение, поиск и извлечение данных, специфичных для отдельного пользователя или общих для всех пользователей.

## Координация файлов

Устраняет несогласованности файловой системы, возникающие из-за одновременных операций чтения и записи от разных процессов. Классы __NSFileCoordinator__ и протокол __NSFilePresenter__ из фреймворка Foundation помогают управлять доступом к файлам и предотвращать конфликты.

## Основные фреймворки

### AddressBook

Предоставлял доступ к контактам пользователя. Позволял приложениям читать, редактировать и управлять записями в адресной книге. В macOS его заменил __Contacts.framework__, который теперь рекомендуется для работы с контактами.

### Core Data

Мощный фреймворк для управления данными, который позволяет:

* Описывать структуру данных с помощью модели.
* Сохранять данные в хранилищах (SQLite, XML, бинарный формат).
* Управлять изменениями и откатами через механизм Undo/Redo.
* Оптимизировать работу с данными с помощью кэширования и ленивой загрузки.
* Применяется для работы со сложными структурами данных и обеспечивает удобную интеграцию с iCloud.

### Core Foundation

Низкоуровневый фреймворк на C, предоставляющий базовые функции работы с:
* Строками (CFStringRef)
* Коллекциями (массивы, словари)
* Потоками ввода-вывода
* Таймерами и т. д.

Часто используется во внутренних API macOS и iOS, а также в фреймворке Foundation.

### Foundation

Предоставляет фундаментальные классы и API для работы с:
* Строками (NSString)
* Коллекциями (NSArray, NSDictionary)
* Датами (NSDate)
* Файловой системой
*Сетевыми запросами (NSURLSession)

Это ключевой фреймворк для разработки на Swift и Objective-C.

### Quick Look

Позволяет приложениям предварительно просматривать файлы различных форматов (PDF, изображения, документы Office и т. д.).

Применяется, например, в Finder и Mail для быстрого просмотра вложений.

### Social

Предоставлял API для взаимодействия с социальными сетями (Facebook, Twitter). Позволял приложениям публиковать посты и отправлять запросы от имени пользователя. В современных версиях __заменён на OSLog и собственные API социальных платформ__.

### Security

Предоставляет механизмы защиты данных, включая:

* Управление сертификатами и ключами (Keychain Services)
* Шифрование данных
* Аутентификацию пользователей
* Поддержку TLS и других протоколов безопасности

Используется в macOS и iOS для хранения паролей, токенов и других защищённых данных.

### WebKit

Движок рендеринга веб-страниц, используемый в Safari и других браузерах. Предоставляет API для встраивания веб-контента в приложения через __WKWebView__. 

Позволяет:

* Загружать и отображать веб-страницы
* Выполнять JavaScript
* Обмениваться данными между веб-страницей и нативным кодом
